

# Ubuntu 사용자 생성 및 초기 패스워드 설정 강제화

Linux 환경에서 보안상의 이유로 관리자가 임시 패스워드를 부여한 뒤, 사용자가 처음 로그인할 때 본인만의 패스워드로 강제 변경하게 하는 설정은 실무에서 매우 중요한 프로세스이다.

## 1. 표준 사용자 생성 명령어 (`adduser` vs `useradd`)

우분투에서 사용자를 생성하는 명령어는 두 가지가 있으나, 교재에서는 보다 직관적이고 인터랙티브한 `adduser`를 권장한다.

### 1.1 `adduser` 명령어 (권장)

이 명령어를 실행하면 시스템이 자동으로 패스워드 입력을 요청한다.

```bash
sudo adduser newuser

```

* **동작:** 실행 즉시 `New password:` 프롬프트가 나타난다. 관리자가 임시 패스워드를 입력하고 사용자에게 전달한다.

### 1.2 `useradd` 명령어

저수준 명령어로, 기본적으로 패스워드 없이 계정만 생성된다. 생성 후 별도로 패스워드를 설정해야 한다.

```bash
sudo useradd newuser
sudo passwd newuser

```

---

## 2. 사용자가 직접 패스워드를 변경하게 하는 방법 (Force Password Change)

관리자가 설정한 임시 패스워드 대신 사용자가 직접 패스워드를 결정하게 하려면, **'첫 로그인 시 패스워드 만료'** 설정을 사용해야 한다.

### 2.1 `chage` 명령어를 이용한 패스워드 만료

이 방법은 사용자가 로그인을 시도하자마자 현재 패스워드(임시)를 확인한 후, 즉시 새로운 패스워드를 입력하도록 강제한다.

```bash
# newuser의 패스워드를 만료시켜 다음 로그인 시 변경 강제
sudo chage -d 0 newuser

```

* `-d 0`: 마지막 패스워드 변경일을 '0'으로 설정하여 시스템이 즉시 변경이 필요한 상태로 인식하게 함.

### 2.2 전체 프로세스 요약 (Best Practice)

1. **계정 생성:** `sudo adduser [아이디]` (임시 패스워드 설정: 예: `Welcome123!`)
2. **변경 강제:** `sudo chage -d 0 [아이디]`
3. **사용자 안내:** 사용자에게 아이디와 임시 패스워드를 전달한다.
4. **사용자 로그인:** 사용자가 SSH 등으로 접속 시 다음과 같은 흐름이 발생한다.
* (current) UNIX password: [임시 패스워드 입력]
* Enter new UNIX password: [사용자가 쓸 새 패스워드 입력]
* Retype new UNIX password: [새 패스워드 확인]



---

## 3. 클라우드 환경(AWS 등)에서의 고려사항

AWS EC2의 Ubuntu 인스턴스는 기본적으로 패스워드 로그인이 비활성화되어 있고 **Key Pair(.pem)** 방식을 사용한다.

### 3.1 패스워드 인증 활성화 시 주의 (과금 관련)

패스워드 방식으로 로그인을 허용하려면 `/etc/ssh/sshd_config` 파일에서 `PasswordAuthentication`을 `yes`로 변경해야 한다.

> **[보안 및 관리 주의]**
> * **무차별 대입 공격(Brute Force):** 패스워드 인증을 허용하면 외부 해커의 로그인 시도가 급증한다. 이로 인해 시스템 로그 파일 크기가 커져 **EBS(저장 장치) 용량을 차지하여 추가 과금**이 발생하거나, 인스턴스 자원이 소모될 수 있다.
> * **대안:** 가급적 IAM Role이나 개별 Public Key를 등록해 주는 방식을 권장한다.
> 
> 


---

# 리눅스 그룹 관리: 그룹 생성 및 사용자 할당

리눅스 시스템에서 그룹(Group)은 파일 및 디렉토리에 대한 권한을 효율적으로 관리하기 위해 사용된다. 여러 사용자에게 동일한 권한을 부여해야 할 경우, 개별적으로 설정하는 대신 그룹에 사용자를 추가하여 일괄 관리하는 것이 정석이다.

## 1. 그룹 생성 (groupadd)

새로운 프로젝트나 부서 단위의 그룹을 생성할 때 사용한다.

```bash
# 'devops'라는 이름의 새로운 그룹 생성
sudo groupadd devops

```

* **확인 방법:** `/etc/group` 파일을 조회하여 그룹이 정상적으로 생성되었는지 확인한다.
```bash
grep "devops" /etc/group

```



---

## 2. 사용자를 그룹에 추가 (usermod / gpasswd)

기존에 존재하는 사용자를 특정 그룹에 추가하는 방법은 크게 두 가지 명령어로 나뉜다.

### 2.1 `usermod` 명령어 사용 (권장)

사용자의 속성을 변경하는 명령어로, `-aG` 옵션을 사용하여 기존 그룹 목록을 유지하면서 새 그룹을 추가한다.

```bash
# 'newuser'라는 사용자를 'devops' 그룹에 추가
sudo usermod -aG devops newuser

```

* **주의:** `-a` (append) 옵션 없이 `-G`만 사용할 경우, 사용자가 기존에 속해 있던 다른 모든 보조 그룹에서 제외되고 오직 해당 그룹만 남게 되므로 반드시 함께 사용해야 한다.

### 2.2 `gpasswd` 명령어 사용

그룹의 암호나 멤버를 관리하는 전용 명령어로, 사용법이 직관적이다.

```bash
# 'devops' 그룹에 'newuser'를 멤버로 추가
sudo gpasswd -a newuser devops

```

---

## 3. 사용자 그룹 소속 확인

사용자가 어떤 그룹에 속해 있는지 확인하는 방법은 다음과 같다.

1. **현재 로그인된 사용자 확인:**
```bash
groups

```


2. **특정 사용자 확인:**
```bash
groups [사용자이름]
# 또는 상세 정보 확인
id [사용자이름]

```



---

## 4. 실무 적용: 그룹 기반 권한 설정 예시

그룹을 생성하고 사용자를 추가했다면, 실제 디렉토리에 권한을 부여하여 협업 환경을 구축할 수 있다.

```bash
# 1. 특정 폴더의 소유 그룹을 'devops'로 변경
sudo chgrp devops /shared_project

# 2. 그룹 멤버들에게 쓰기 권한 부여
sudo chmod 775 /shared_project

```

---

## 5. 클라우드 환경 및 보안 주의사항 (과금 관련)

AWS EC2 등의 환경에서 다수의 사용자를 관리할 때 다음과 같은 점을 유의해야 한다.

> **[운영 및 보안 가이드]**
> * **EBS 볼륨 권한:** 그룹 권한을 잘못 설정하여 로그 파일이 비정상적으로 누적되거나, 누구나 대용량 파일을 업로드할 수 있게 되면 **EBS 저장 용량 초과로 인한 추가 비용**이 발생할 수 있다.
> * **sudo 권한 관리:** 사용자를 `sudo` 그룹(또는 `wheel`)에 추가하면 관리자 권한을 가지게 된다. 불필요한 관리자 권한 부여는 시스템 변조 및 보안 침해의 원인이 되므로 최소 권한 원칙을 준수해야 한다.
> 
> 

---

**Next Step:**
리눅스 파일 시스템 권한(Permission) 구조와 그룹 기반 ACL(Access Control List) 설정 방법
