이제 AWS 클라우드에 **Ubuntu Linux 인스턴스**를 성공적으로 실행하셨으니, 실제 서비스를 위한 **웹 서버**와 **파일 서버**를 구축하는 단계입니다. 이 과정은 **보안(Security)**과 **운영(Operations)** 관점에서 가장 중요합니다.

---

## 🔑 1단계: 서버 접속 확인 및 초기 환경 설정

가장 먼저 SSH 접속을 통해 인스턴스의 상태를 확인하고 시스템을 최신 상태로 유지하는 것이 **보안 취약점**을 줄이는 기본입니다.

1.  **SSH 접속 재확인:**
    $$\text{ssh -i my-key.pem ubuntu@\[퍼블릭 IP 주소]}$$

2.  **시스템 업데이트:**
    현재 설치된 패키지 목록을 갱신하고 시스템을 최신 버전으로 업그레이드합니다.
    $$\text{sudo apt update}$$
    $$\text{sudo apt upgrade -y}$$

---

## 🌐 2단계: 웹 서버 구축 (Apache2 사용)

가장 보편적이고 설정이 간단한 **Apache2 웹 서버**를 설치하여, 클라우드 서버에 접속했을 때 웹 페이지가 보이도록 설정합니다.

### 2.1. Apache2 설치

Ubuntu 패키지 관리자인 `apt`를 사용하여 Apache2를 설치합니다.

$$\text{sudo apt install apache2 -y}$$

### 2.2. 서비스 상태 확인

설치 후 서비스가 정상적으로 실행 중인지 확인합니다.

$$\text{sudo systemctl status apache2}$$
(상태가 `active (running)`인지 확인합니다.)

### 2.3. AWS 보안 그룹(방화벽) 설정 **(필수)**

인스턴스 내부에서 웹 서버를 구동했더라도, 외부에서 접속하려면 AWS의 **보안 그룹(Security Group)**에서 HTTP 포트 $80$에 대한 접근을 **명시적으로 허용**해야 합니다.

1.  **AWS 콘솔 접속** $\to$ EC2 $\to$ 인스턴스 $\to$ 보안 그룹 클릭.
2.  **인바운드 규칙 편집** $\to$ 새로운 규칙 추가.
    * **유형:** `HTTP` (포트 $80$)
    * **소스:** `Anywhere-IPv4` (`0.0.0.0/0`)
3.  **저장:** 규칙을 저장합니다.

### 2.4. 웹 브라우저 테스트

웹 브라우저를 열고 인스턴스의 **퍼블릭 IP 주소**를 입력하여 접속합니다.
$$\text{http://[퍼블릭 IP 주소]}$$

정상적으로 접속되면 **"Apache2 Ubuntu Default Page"**라는 기본 웹 페이지가 나타납니다. 이제 이 서버는 웹 서비스를 제공할 수 있습니다.

> **웹 파일 경로:** 웹 페이지의 실제 파일은 보통 `/var/www/html/` 경로에 위치하며, 여기에 HTML, Python 파일 등을 업로드하여 웹 서비스를 구축합니다.

---

## 📁 3단계: 파일 서버 구축 (SFTP 사용)

클라우드 서버에서 가장 안전하고 추천되는 파일 전송 방식은 **SFTP(Secure File Transfer Protocol)**를 사용하는 것입니다. SSH 접속 기능에 파일 전송 기능이 포함되어 있어 **별도의 설치가 필요 없습니다.**

### 3.1. 전용 파일 서버 사용자 생성

보안을 위해, 시스템 관리용 사용자(`ubuntu`)와 별개로 파일 업로드/다운로드 전용 사용자를 생성합니다.

1.  **새 사용자 생성:**
    $$\text{sudo adduser fileuser}$$
    (비밀번호를 설정하고, 나머지 정보는 Enter를 눌러 넘어갑니다.)

2.  **웹 서버 폴더 권한 설정:**
    파일 서버 사용자가 웹 서버 폴더에 파일을 업로드할 수 있도록 권한을 설정합니다.

    * `www-data` 그룹에 `fileuser`를 추가합니다.
        $$\text{sudo usermod -aG www-data fileuser}$$
    * `/var/www/html` 폴더의 그룹 쓰기 권한을 허용합니다.
        $$\text{sudo chmod -R 775 /var/www/html}$$
    * `/var/www/html` 폴더의 소유 그룹을 `www-data`로 변경하고, 새 파일 생성 시 그룹 권한을 상속받도록 설정합니다.
        $$\text{sudo chown -R ubuntu:www-data /var/www/html}$$

### 3.2. SFTP 클라이언트를 통한 접속

PC에 설치된 **FileZilla, WinSCP, MobaXterm** 등의 SFTP 클라이언트 프로그램을 사용하여 접속합니다.

1.  **프로토콜:** SFTP 또는 SSH
2.  **호스트:** 인스턴스의 **퍼블릭 IP 주소**
3.  **사용자 이름:** $\text{fileuser}$
4.  **비밀번호:** $\text{fileuser}$ 생성 시 설정한 비밀번호
5.  **포트:** $22$

접속 후, 클라이언트의 원격 사이드에서 `/var/www/html/` 경로로 이동하여 파일을 업로드하면, 웹 서버를 통해 바로 서비스할 수 있습니다.

---

> **IT 전문가 팁 (DB 서버 파일 관리):**
>
> **보안**을 위해 **DB 서버**와 같은 중요한 인스턴스에는 **SFTP 외의 다른 파일 공유 프로토콜(Samba 등)**을 설치하지 않는 것이 기본 원칙입니다. 필요한 모든 파일 관리는 **SSH와 SFTP**를 통해 안전한 **암호화 통신**으로 처리해야 합니다.
