AWS Linux 서버 환경을 **Ubuntu**로 변경하여 DNS 서버 구축 가이드(BIND 사용)를 다시 정리해 드리겠습니다. IT 전문가 강사님의 전문성과 수강생들의 실습 환경을 고려하여, **실전 팁**과 **자주 실수하는 부분**을 강조했습니다.

-----

## AWS Ubuntu 서버에 DNS 서버 구축 가이드 (BIND 사용) 🐧

이 강의록은 **Ubuntu Server (LTS 버전 권장)** 환경에서 가장 널리 사용되는 DNS 소프트웨어인 \*\*BIND9 (Berkeley Internet Name Domain version 9)\*\*를 이용한 구축 과정을 다룹니다.

### 1\. 전제 조건 및 준비 사항

| 항목 | 상세 내용 | 실전 팁 |
| :--- | :--- | :--- |
| **AWS EC2 인스턴스** | Ubuntu 22.04 LTS 등의 안정적인 버전 사용. `t2.micro` 이상의 인스턴스 준비. | \*\*Elastic IP(EIP)\*\*를 할당하여 서버의 공인 IP를 고정하세요. DNS 서버의 IP 변경은 서비스 중단을 야기합니다. |
| **보안 그룹 (Security Group)** | **인바운드 규칙**에 **UDP/TCP 포트 53**을 반드시 허용해야 합니다. (DNS 기본 포트) | **보안**을 위해 실제 서비스에서는 `0.0.0.0/0` 대신, DNS 서버를 사용할 특정 **VPC CIDR 대역**이나 IP 범위로 제한해야 합니다. |
| **시스템 업데이트** | 최신 보안 패치 및 패키지 목록을 유지하는 것은 IT 전문가의 기본입니다. | `sudo apt update && sudo apt upgrade -y`를 실행하고 시작하세요. |

-----

### 2\. BIND9 (bind9) 패키지 설치

Ubuntu에서는 `apt` 패키지 관리자를 사용합니다.

```bash
# 패키지 목록 업데이트
sudo apt update

# BIND9 및 유틸리티 설치
sudo apt install bind9 dnsutils -y
```

  - **`bind9`**: DNS 서버 데몬(named) 본체입니다.
  - **`dnsutils`**: `dig`, `nslookup`, `host` 등 DNS 테스트 및 조회 유틸리티입니다.

-----

### 3\. BIND9 설정 파일 수정 (기본 설정)

Ubuntu의 BIND9 메인 설정 파일은 `/etc/bind/named.conf.options`와 `/etc/bind/named.conf.local`입니다.

#### 3.1. 기본 옵션 설정 (`/etc/bind/named.conf.options`)

서버가 들어오는 요청을 수신할 IP와 쿼리를 허용할 IP를 설정합니다.

```bash
sudo vi /etc/bind/named.conf.options
```

**[수정할 주요 내용]**

`options { ... };` 블록 내부를 수정합니다.

1.  **Listen IP 주소 변경:**
    ```text
    listen-on { 127.0.0.1; };  <-- 이 부분을
    listen-on { any; };        <-- 또는 listen-on { your_private_ip; }; 로 변경
    ```
      * **실전 팁:** EC2 인스턴스의 **사설 IP (Private IP)** 주소로 명시하는 것이 좋습니다. `any;`는 테스트용으로 사용하세요.
2.  **쿼리 허용 IP 주소 변경:**
    ```text
    allow-query { any; };
    ```
      * 이 서버를 사용할 클라이언트의 IP 대역을 명시해야 합니다. (예: `allow-query { 10.0.0.0/16; 127.0.0.1; };`)

#### 3.2. 포워더 설정 (선택 사항)

자체적으로 해석할 수 없는 도메인(예: Google, Daum)에 대한 질의를 전달할 상위 DNS 서버를 지정합니다.

```text
forwarders {
    168.126.63.1;  // KT DNS
    210.220.163.82;  // SK Broadband DNS
};
```

  * **실전 팁:** AWS 환경이라면 \*\*VPC의 기본 DNS 서버 (VPC CIDR + 2 주소)\*\*를 포워더로 지정하는 것도 좋은 방법입니다.

-----

### 4\. Zone 파일 정의 및 생성

구축할 도메인(예: `mycompany.local`)의 영역을 정의하고 레코드를 설정합니다.

#### 4.1. Zone 정의 (`/etc/bind/named.conf.local`)

사용자 도메인 영역을 추가합니다.

```bash
sudo vi /etc/bind/named.conf.local
```

**[추가할 내용 예시]**

```text
// My Forward Zone
zone "mycompany.local" {
    type master;
    file "/etc/bind/db.mycompany.local";  // Zone 파일 경로
};
```

#### 4.2. Zone 파일 생성

Ubuntu의 Zone 파일은 보통 `/etc/bind/` 경로에 저장합니다.

```bash
sudo cp /etc/bind/db.local /etc/bind/db.mycompany.local
sudo vi /etc/bind/db.mycompany.local
```

**[Zone 파일 내용 예시]** (파일 내의 IP와 호스트명을 환경에 맞게 수정)

```text
$TTL    604800
@       IN      SOA     ns1.mycompany.local. admin.mycompany.local. (
                             2025101601         ; Serial (YYYYMMDDNN)
                             604800             ; Refresh
                              86400             ; Retry
                            2419200             ; Expire
                             604800 )           ; Negative Cache TTL
;
@       IN      NS      ns1.mycompany.local.
ns1     IN      A       192.168.1.10    ; DNS 서버 자체의 IP (예시)
web     IN      A       192.168.1.20    ; 웹 서버의 IP
db      IN      A       192.168.1.30    ; DB 서버의 IP
```

  * **자주 오해하는 부분:** **SOA 레코드**의 이메일 주소는 `@` 대신 \*\*마침표(.)\*\*를 사용하여 `admin.mycompany.local.` 형식으로 작성해야 합니다.

-----

### 5\. 서비스 시작 및 활성화

설정 파일의 문법적 오류를 검증한 후, BIND9 서비스를 시작합니다.

```bash
# 설정 파일 문법 검증
sudo named-checkconf

# Zone 파일 문법 검증 (Zone 파일 이름과 경로 확인)
sudo named-checkzone mycompany.local /etc/bind/db.mycompany.local

# BIND9 서비스 재시작 (설정 변경 적용)
sudo systemctl restart bind9

# 서비스 상태 확인
sudo systemctl status bind9
```

  * **에러 발생 시 팁:** `sudo journalctl -xe | grep named` 명령어로 로그를 확인하면 에러의 원인을 찾기 쉽습니다.

-----

### 6\. DNS 테스트 (Client 측)

DNS 서버 IP를 클라이언트에서 설정하고, 이름 해석이 정상적으로 이루어지는지 확인합니다.

#### 6.1. 클라이언트 설정 (테스트용)

테스트할 EC2 인스턴스에서 네임 서버 설정을 변경합니다. Ubuntu에서는 **Netplan** 또는 \*\*`resolv.conf`\*\*를 수정할 수 있습니다.

```bash
# /etc/resolv.conf에 임시 추가 (재부팅 시 사라질 수 있음)
echo "nameserver 192.168.1.10" | sudo tee -a /etc/resolv.conf
```

#### 6.2. DNS 질의 테스트

`dig` 유틸리티를 사용하여 도메인이 올바르게 해석되는지 확인합니다.

```bash
# web.mycompany.local 에 대한 질의 테스트
dig web.mycompany.local
```

  - **결과 확인:** `ANSWER SECTION`에 설정한 IP 주소(예: `192.168.1.20`)가 정확히 표시되면 성공입니다.

-----

### 💡 실전 팁: AWS 네트워킹 통합

  * **Route 53 Private Hosted Zone 활용:** 클라우드 환경에서는 BIND 서버를 직접 구축하는 것보다 **AWS Route 53 Private Hosted Zone**을 사용하여 사설 도메인을 관리하는 것이 운영 편의성과 통합성 면에서 훨씬 우수합니다. BIND는 레거시 환경이나 특정 요구 사항(예: 복잡한 조건부 포워딩)이 있을 때 고려하세요.
  * **VPC DHCP 옵션 세트:** 여러 클라이언트 서버에 DNS 설정을 일괄 적용하려면, **VPC 대시보드**에서 **DHCP 옵션 세트**를 새로 생성하거나 수정하여, **도메인 이름 서버** 항목에 구축한 DNS 서버의 **사설 IP**를 지정해야 합니다. 이것이 AWS 환경에서 서버 관리를 효율화하는 **정석**입니다.

**출처:** Ubuntu Server Guide, BIND9 Documentation




 **대한민국의 주요 DNS 서버 제공 회사와 그 IP 주소**

우리나라에서 일반적으로 사용되는 DNS 서버는 주로 대형 **인터넷 서비스 제공업체(ISP)**에서 제공하며, 사용자가 직접 설정하여 속도나 안정성을 높일 수 있는 **공개 DNS(Public DNS)**도 함께 참고하는 것이 좋습니다.

---

## 대한민국 주요 DNS 서버 및 IP 주소 목록

| 구분 | 회사/제공기관 | 기본 (Primary) DNS IP (IPv4) | 보조 (Secondary) DNS IP (IPv4) | 실전 팁 |
| :--- | :--- | :--- | :--- | :--- |
| **주요 ISP** | **KT (케이티)** | `168.126.63.1` | `168.126.63.2` | 국내에서 가장 보편적으로 사용되며, 안정성이 높은 편입니다. |
| | **SK Broadband (SKB)** | `210.220.163.82` | `219.250.36.130` | 구 (舊) 하나로텔레콤 망을 사용하는 사용자에게 기본으로 할당됩니다. |
| | **LG U+ (LG유플러스)** | `164.124.101.2` | `203.248.252.2` | 구 (舊) LG데이콤, 파워콤 망을 사용하는 사용자에게 할당됩니다. |
| **공개 DNS** | **Google Public DNS** | `8.8.8.8` | `8.8.4.4` | 글로벌 DNS 서비스로, 빠르고 안정적이며 **보안성(DNS over HTTPS 등)**을 중요시하는 경우 사용됩니다. |
| | **Cloudflare DNS** | `1.1.1.1` | `1.0.0.1` | 매우 빠른 속도와 높은 개인 정보 보호를 강조하는 서비스입니다. |
| **국가 기관** | **KISA (.kr/.한국 DNS)** | (특정 IP 없음) | (특정 IP 없음) | `b.dns.kr` / `c.dns.kr` 등 루트 서버 역할을 수행하며, ISP가 이 서버들을 통해 최종 정보를 획득합니다. 일반 사용자가 직접 설정하지는 않습니다. |

---

### 💡 팁: DNS 설정 시 유의사항

1.  **ISP와 Public DNS 조합:**
    * **실전 팁:** 1차 DNS는 본인이 사용하는 **ISP** 주소로 설정하고, 2차 DNS는 **Google**(`8.8.8.8`)이나 **Cloudflare**(`1.1.1.1`)와 같은 **공개 DNS**로 설정하는 것을 추천합니다. 이렇게 하면 국내 서비스에 대한 빠른 응답 속도를 유지하면서, ISP DNS에 장애가 발생할 경우를 대비할 수 있어 **안정성**이 높아집니다.
    * **자주 오해하거나 실수하는 부분:** 무조건 공개 DNS가 빠르다고 생각하고 설정하지만, ISP DNS는 국내망 최적화가 잘 되어 있어 국내 서비스 접근 시 오히려 더 빠를 수 있습니다.

2.  **보안 및 개인 정보 보호 (보안):**
    * 최근 DNS는 단순 이름 해석을 넘어 **보안** 기능이 강조됩니다. **Google**이나 **Cloudflare** 같은 공개 DNS는 **DNS over HTTPS (DoH)**나 **DNS over TLS (DoT)**를 지원하여, DNS 질의 패킷을 암호화함으로써 중간자 공격이나 스니핑을 방지할 수 있습니다. 수강생들에게 **보안 트렌드**로 설명해 주시면 좋습니다.

3.  **Route 53과의 연계 (AI/Cloud):**
    * 클라우드 환경(AWS)에서는 자체적인 **DNS 서비스(Route 53)**를 사용하며, 이 서비스를 통해 내부(VPC) 및 외부 도메인 관리가 통합적으로 이루어집니다. DNS 서버 구축 시 ISP의 DNS는 **포워더(Forwarder)**로 활용되거나 최종 레졸루션에 사용되는 등 계층적으로 접근됩니다.

---

