

# Ubuntu Nginx 웹 서버 구축 및 구성

## 1. 개요

**Nginx(엔진엑스)**는 가볍고 높은 성능을 목표로 개발된 웹 서버 소프트웨어이다. Apache HTTP Server와 비교하여 동시 접속 처리에 특화된 **이벤트 기반(Event-Driven)** 구조를 가지고 있어, 정적 파일 서빙, 리버스 프록시(Reverse Proxy), 로드 밸런싱 용도로 널리 사용된다.

본 장에서는 Ubuntu 환경에서 Nginx를 설치하고, 기본적인 정적 웹 사이트를 호스팅하기 위한 **Server Block(가상 호스트)** 구성 방법을 다룬다.

---

## 2. Nginx 설치 (Installation)

Ubuntu의 공식 리포지토리(Repository)를 통해 패키지를 설치한다.

### 2.1 패키지 인덱스 업데이트

최신 패키지 정보를 가져오기 위해 업데이트를 수행한다.

```bash
sudo apt update

```

### 2.2 Nginx 설치

```bash
sudo apt install nginx -y

```

---

## 3. 방화벽(UFW) 설정

Ubuntu에는 기본 방화벽인 UFW(Uncomplicated Firewall)가 활성화되어 있을 수 있다. Nginx가 외부 요청을 받을 수 있도록 포트를 허용해야 한다.

### 3.1 Nginx 애플리케이션 프로필 확인

```bash
sudo ufw app list

```

* **Nginx HTTP:** 80번 포트만 허용 (암호화되지 않은 웹 트래픽)
* **Nginx HTTPS:** 443번 포트만 허용 (TLS/SSL 암호화 트래픽)
* **Nginx Full:** 80, 443번 포트 모두 허용

### 3.2 HTTP 포트 허용

SSL 인증서가 없는 초기 상태이므로 80번 포트를 허용한다.

```bash
sudo ufw allow 'Nginx HTTP'

```

### 3.3 상태 확인

```bash
sudo ufw status

```

* 출력 결과에 `Nginx HTTP ALLOW`가 표시되어야 한다.

---

## 4. 웹 서버 구동 확인

설치가 완료되면 Nginx 서비스가 자동으로 시작된다.

### 4.1 서비스 상태 확인

```bash
systemctl status nginx

```

* `active (running)` 상태인지 확인한다.

### 4.2 브라우저 접속 테스트

서버의 공인 IP 주소(Public IP) 또는 도메인을 브라우저 주소창에 입력한다.

* 주소: `http://서버_IP_주소`
* **"Welcome to nginx!"** 라는 기본 페이지가 보이면 설치가 성공한 것이다.

> **Tip:** 서버의 공인 IP를 모를 경우 터미널에서 `curl -4 icanhazip.com` 명령어로 확인할 수 있다.

---

## 5. 실무 구성: Server Block (가상 호스트) 설정

Nginx의 기본 설정(`default`)을 수정해서 사용하는 것보다, 도메인별로 별도의 설정 파일(**Server Block**)을 만들어 관리하는 것이 표준이다. 여기서는 `example.com`이라는 도메인(또는 임의의 프로젝트)을 위한 사이트를 구축한다고 가정한다.

### 5.1 웹 루트 디렉터리 생성

Nginx의 기본 경로는 `/var/www/html`이다. 프로젝트별로 디렉터리를 분리한다.

```bash
# -p 옵션: 상위 디렉터리까지 자동 생성
sudo mkdir -p /var/www/example.com/html

```

### 5.2 소유권 변경 및 권한 설정

현재 `root` 계정 소유로 되어 있으므로, 일반 사용자(`$USER`)가 수정할 수 있도록 권한을 조정한다.

```bash
sudo chown -R $USER:$USER /var/www/example.com/html
sudo chmod -R 755 /var/www/example.com

```

### 5.3 테스트용 index.html 생성

```bash
nano /var/www/example.com/html/index.html

```

**파일 내용 작성:**

```html
<html>
    <head>
        <title>Welcome to Example.com!</title>
    </head>
    <body>
        <h1>Success! The Nginx server block is working!</h1>
    </body>
</html>

```

### 5.4 Server Block 설정 파일 생성

Nginx 설정은 `/etc/nginx/sites-available/`에 작성하고, 이를 `/etc/nginx/sites-enabled/`로 링크(Link)하여 활성화하는 구조이다.

```bash
sudo nano /etc/nginx/sites-available/example.com

```

**설정 내용 작성:**

```nginx
server {
    listen 80;
    listen [::]:80;

    root /var/www/example.com/html;
    index index.html index.htm index.nginx-debian.html;

    server_name example.com www.example.com; # 실제 도메인 또는 공인 IP 입력

    location / {
        try_files $uri $uri/ =404;
    }
}

```

### 5.5 설정 활성화 (Symbolic Link)

작성한 설정 파일을 `sites-enabled` 디렉터리에 심볼릭 링크로 연결하여 Nginx가 읽을 수 있도록 한다.

```bash
sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/

```

### 5.6 (선택 사항) 기본 설정 해제

필요하다면 기본 설정(`default`)이 충돌하지 않도록 링크를 해제할 수 있다. (필수는 아님)

```bash
# sudo unlink /etc/nginx/sites-enabled/default

```

---

## 6. 설정 검증 및 서비스 재시작

설정 파일을 수정한 후에는 반드시 문법 오류(Syntax Error)를 확인해야 한다.

### 6.1 문법 검사

```bash
sudo nginx -t

```

* **결과:** `syntax is ok`, `test is successful` 메시지가 나와야 한다. 오류가 있다면 해당 라인을 수정해야 한다.

### 6.2 Nginx 재시작

```bash
sudo systemctl restart nginx

```

이제 브라우저에서 설정한 도메인(또는 IP)으로 접속하면, 5.3에서 작성한 "Success!" 페이지가 표시된다.

---

## 7. 주요 Nginx 관리 명령어 요약

| 명령어 | 기능 |
| --- | --- |
| `sudo systemctl start nginx` | 서버 시작 |
| `sudo systemctl stop nginx` | 서버 중지 |
| `sudo systemctl restart nginx` | 서버 중지 후 다시 시작 (서비스 중단 발생) |
| `sudo systemctl reload nginx` | **[권장]** 연결 끊김 없이 설정만 다시 불러오기 |
| `sudo systemctl disable nginx` | 부팅 시 자동 시작 해제 |
| `sudo systemctl enable nginx` | 부팅 시 자동 시작 설정 (기본값) |

---

Next Step: Nginx 리버스 프록시(Reverse Proxy) 설정과 WAS(Tomcat/Node.js) 연동 방법
