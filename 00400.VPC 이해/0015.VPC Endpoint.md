AWS **VPC 엔드포인트(VPC Endpoint)**는 인터넷 게이트웨이, NAT 게이트웨이, VPN 연결 또는 Direct Connect를 거치지 않고도 VPC와 지원되는 AWS 서비스 및 VPC 엔드포인트 서비스 간의 통신을 가능하게 하는 기술입니다. 이를 통해 트래픽이 공용 인터넷을 통하지 않고 AWS 내부 네트워크망 내에서만 이동하게 됩니다.

---

## 1. VPC 엔드포인트의 종류

사용하려는 AWS 서비스의 특성에 따라 두 가지 유형 중 하나를 선택합니다.

### ① 인터페이스 엔드포인트 (Interface Endpoint)

* **기술 방식**: AWS PrivateLink를 사용합니다.
* **구동 방식**: 서브넷 내부에 프라이빗 IP를 가진 **가상 네트워크 인터페이스(ENI)**를 생성합니다.
* **대상 서비스**: CloudWatch, Kinesis, EC2 API, SNS 등 대부분의 AWS 서비스 및 Marketplace 서비스.
* **보안**: 보안 그룹(Security Group)을 통해 트래픽 제어가 가능합니다.

### ② 게이트웨이 엔드포인트 (Gateway Endpoint)

* **구동 방식**: 라우팅 테이블에 특정 서비스로 향하는 경로(Route)를 추가하는 방식입니다.
* **대상 서비스**: **S3** 및 **DynamoDB** 두 가지만 지원합니다.
* **보안**: 엔드포인트 정책(IAM 정책과 유사)을 통해 접근을 제어합니다.

---

## 2. 왜 VPC 엔드포인트를 사용하는가?

1. **보안성**: 트래픽이 공용 인터넷 노출 없이 AWS 백본 네트워크를 통해서만 전달되므로 가로채기나 외부 공격 위험이 현저히 낮습니다.
2. **네트워크 비용 최적화**: 특히 **게이트웨이 엔드포인트(S3, DynamoDB)**는 데이터 전송료가 **무료**이므로, NAT 게이트웨이를 통해 S3에 접근할 때 발생하는 높은 데이터 처리비를 절감할 수 있습니다.
3. **간소화된 관리**: 인터넷 게이트웨이나 NAT 게이트웨이를 구성할 필요 없이 프라이빗 서브넷에서 직접 서비스에 접근할 수 있습니다.

---

## 3. 실무 설정 사례: 프라이빗 S3 접근

프라이빗 서브넷의 인스턴스가 S3 버킷에 데이터를 업로드해야 하는 상황입니다.

### 게이트웨이 엔드포인트 설정 (S3 기준)

1. **엔드포인트 생성**: `com.amazonaws.ap-northeast-2.s3` 서비스를 선택합니다.
2. **라우팅 테이블 선택**: 인스턴스가 속한 프라이빗 서브넷의 라우팅 테이블을 체크합니다.
3. **라우팅 결과 확인**: 라우팅 테이블에 아래와 같은 항목이 자동으로 생성됩니다.

| 대상 (Destination) | 타겟 (Target) | 설명 |
| --- | --- | --- |
| `pl-63a5400a (S3 CIDR)` | `vpce-1a2b3c4d` | S3행 트래픽은 엔드포인트로 전송 |

---

## 4. AWS 과금 및 유료 전환 주의 사항 (2026년 기준)

엔드포인트 유형에 따라 과금 방식이 완전히 다르므로 주의가 필요합니다.

| 엔드포인트 유형 | 시간 요금 (Seoul 기준) | 데이터 처리 요금 | 비고 |
| --- | --- | --- | --- |
| **인터페이스 (PrivateLink)** | **$0.01 / 시간당 (AZ당)** | **$0.01 / GB** | 가용 영역마다 개별 부과 |
| **게이트웨이 (S3/DynamoDB)** | **무료** | **무료** | 적극 사용 권장 (비용 절감 핵심) |

> [!WARNING]
> **과금 주의 사항**
> * **인터페이스 엔드포인트**는 각 가용 영역(AZ)마다 ENI를 생성하므로, 3개의 AZ에 모두 생성하면 시간당 요금도 3배가 됩니다.
> * 2026년 기준, 퍼블릭 IPv4 주소 과금($0.005/h)을 피하기 위해 인터페이스 엔드포인트를 사용하는 것이 보안과 관리 측면에서 유리할 수 있으나, 전송 데이터 양이 매우 많다면 데이터 처리 요금을 계산해 보아야 합니다.
> 
> 

---

VPC 엔드포인트 정책은 엔드포인트를 통해 접근할 수 있는 AWS 리소스를 제어하는 **리소스 기반 정책**입니다. IAM 정책과 문법은 동일하지만, '누가 어떤 서비스에 접근할 수 있는지'를 엔드포인트 길목에서 한 번 더 검증하는 강력한 보안 계층입니다.

---

## 1. 엔드포인트 정책의 특징

* **독립적 검증**: 사용자(IAM)에게 권한이 있더라도, 엔드포인트 정책에서 거부(Deny)하면 접근이 불가능합니다.
* **인터넷 차단**: 엔드포인트를 통하는 트래픽에만 적용됩니다. (인터넷 게이트웨이를 통하는 트래픽에는 영향 없음)
* **기본값**: 생성 시 기본 정책은 `Full Access` (모든 접근 허용)입니다. 보안을 위해 이를 최소 권한 원칙으로 수정하는 것이 권장됩니다.

---

## 2. 주요 시나리오별 정책 작성 사례

### 사례 1: 특정 S3 버킷만 접근 허용 (데이터 유출 방지)

사내 보안 규정상 프라이빗 서브넷의 인스턴스가 우리 회사의 특정 버킷(`my-company-data`) 외에 개인 버킷이나 외부 버킷으로 데이터를 업로드하는 것을 막아야 할 때 사용합니다.

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowAccessToSpecificBucketOnly",
      "Effect": "Allow",
      "Principal": "*",
      "Action": [
        "s3:GetObject",
        "s3:PutObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::my-company-data",
        "arn:aws:s3:::my-company-data/*"
      ]
    }
  ]
}

```

### 사례 2: 특정 IAM 역할(Role)만 엔드포인트 사용 허용

엔드포인트를 사용할 수 있는 주체를 제한하여, 동일한 VPC 내에 있더라도 승인되지 않은 작업자가 서비스를 이용하는 것을 방지합니다.

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowSpecificRoleOnly",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:role/DataAnalystRole"
      },
      "Action": "s3:*",
      "Resource": "*"
    }
  ]
}

```

---

## 3. 정책 적용 시 주의 사항 (Best Practices)

### ① 보안 그룹(SG)과의 차이점

* **보안 그룹**: IP 및 포트 번호를 기준으로 '통로' 자체를 열거나 닫습니다.
* **엔드포인트 정책**: '어떤 데이터(Resource)'에 '어떤 행위(Action)'를 하는지 세부 내용을 검사합니다.
* **권장**: 보안 그룹으로는 443(HTTPS) 포트만 열고, 엔드포인트 정책으로 상세 권한을 제어하는 이중 방어를 구축하세요.

### ② Principal 설정

엔드포인트 정책에서 `Principal: "*"`로 설정하더라도, 실제로는 해당 엔드포인트를 사용하는 IAM 사용자/역할의 권한이 우선합니다. 따라서 `Allow` 정책 작성 시 `Principal`은 폭넓게 잡되 `Resource`를 엄격하게 제한하는 방식이 일반적입니다.

### ③ S3 게이트웨이 엔드포인트 특이사항

게이트웨이 엔드포인트 정책을 수정할 때는 기존의 라우팅 테이블 연결이 끊기지 않도록 주의해야 합니다. 잘못된 정책(Deny 위주)을 적용하면 즉시 해당 서브넷의 S3 통신이 단절될 수 있습니다.

---

## 4. 비용 및 관리 효율성

* **비용**: 엔드포인트 정책 추가/수정은 **무료**입니다.
* **유료 전환 관련**: 2026년 기준, 정책 관리 자체로 비용이 발생하지는 않으나 인터페이스 엔드포인트의 경우 정책으로 인해 통신이 거부되어도 **시간당 유지 비용($0.01/h)**은 계속 발생합니다.

Next Step: VPC 엔드포인트 서비스(PrivateLink) 직접 구축 및 배포

리소스 기반 정책
데이터 유출 방지
IAM 역할 제한
S3 접근 제어

