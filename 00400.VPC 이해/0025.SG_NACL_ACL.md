네트워크 보안 설계에서 가장 핵심이 되는 세 가지 계층인 **보안 그룹(Security Group)**, **네트워크 ACL(NACL)**, 그리고 전통적인 **라우터 ACL(Router ACL)**의 차이점을 분석합니다.

---

## 1. 보안 그룹 vs NACL vs 라우터 ACL 비교

| 구분 | 보안 그룹 (SG) | 네트워크 ACL (NACL) | 라우터 ACL (Standard/Extended) |
| --- | --- | --- | --- |
| **적용 범위** | **인스턴스(ENI) 단위** | **서브넷(Subnet) 단위** | **라우터 인터페이스(VLAN/Physical) 단위** |
| **구동 계층** | Layer 4 (Transport) | Layer 3/4 (Network/Transport) | Layer 3/4 (Standard는 L3 전용) |
| **구동 방식** | **Stateful (상태 유지)** | **Stateless (상태 비저장)** | **Stateless (상태 비저장)** |
| **적용 정책** | 허용(Allow) 규칙만 정의 가능 | 허용(Allow) 및 거부(Deny) 정의 | 허용(Allow) 및 거부(Deny) 정의 |
| **룰 검토 순서** | 모든 규칙을 검토 후 판단 | **규칙 번호 순서대로** 검토 (우선순위) | **작성된 순서대로** 검토 (Top-down) |
| **반환(Return)** | **자동 허용** (들어온 패킷은 나감) | **명시적 허용 필요** (나가는 문 별도) | **명시적 허용 필요** (양방향 별도) |
| **적용 대상** | AWS 리소스 (EC2, RDS 등) | VPC 서브넷 경계 | 온프레미스 라우터/L3 스위치 |

---

## 2. 상세 해석 및 비교 분석

### ① 구동 방식: Stateful vs Stateless

이 부분은 실무 설계에서 가장 실수가 많은 영역입니다.

* **보안 그룹 (Stateful)**: 인바운드에서 허용된 트래픽에 대한 응답은 아웃바운드 규칙에 상관없이 **자동으로 허용**됩니다. 즉, "기억력"이 있어 나가는 통로를 따로 열어줄 필요가 없습니다.
* **NACL/라우터 ACL (Stateless)**: 기억력이 없습니다. 들어오는 문을 열어줬어도 나가는 문(응답용 임시 포트)을 수동으로 열어주지 않으면 통신이 성립되지 않습니다.

### ② 적용 정책과 규칙 검토 방식

* **보안 그룹**: "기본적으로 모두 차단(Deny)" 상태이며, 내가 신뢰하는 트래픽만 **허용(Allow)** 규칙으로 넣습니다. 모든 규칙을 한꺼번에 검토하여 하나라도 매칭되면 허용합니다.
* **NACL/라우터 ACL**: **번호(Priority)**가 매우 중요합니다. 예를 들어 100번에 "전체 차단"을 넣고 200번에 "내 IP 허용"을 넣으면, 100번에서 이미 트래픽이 드랍되어 통신이 안 됩니다. 따라서 구체적인 규칙을 낮은 번호(우선순위 높음)에 배치해야 합니다.

### ③ 적용 범위 (Layer of Defense)

* **보안 그룹**은 인스턴스 바로 앞의 '개인 보디가드'입니다. 인스턴스마다 다른 정책을 줄 수 있어 매우 세밀한 제어가 가능합니다.
* **NACL**은 서브넷이라는 '마을의 성문'입니다. 서브넷 안의 모든 리소스에 공통적으로 적용될 차단 정책(예: 특정 국가 IP 차단)을 넣기에 적합합니다.
* **라우터 ACL**은 실제 물리 장비나 가상 라우터 인터페이스에 적용되며, 클라우드 외부(온프레미스)와의 접점에서 주로 사용됩니다.

---

## 3. 룰 검토 적용 및 방법 가이드

실제 환경에서 이들을 조합하여 사용할 때는 다음과 같은 순서로 적용합니다.

1. **차단 위주(Blacklist)는 NACL/라우터 ACL**: 보안 사고를 유발하는 특정 IP 대역이나 유해 포트를 서브넷/네트워크 진입 단계에서 미리 차단합니다.
2. **허용 위주(Whitelist)는 보안 그룹**: 서비스에 필요한 최소한의 포트(예: 80, 443)만 인스턴스 레벨에서 허용합니다.
3. **임시 포트 관리**: NACL이나 라우터 ACL 사용 시 반드시 **1024-65535** 대역의 아웃바운드/인바운드 허용 규칙이 있는지 확인해야 서비스 장애를 방지할 수 있습니다.

> [!IMPORTANT]
> **과금 및 성능 관련**
> * AWS에서 보안 그룹과 NACL 사용은 **무료**입니다.
> * 단, 너무 많은 수의 규칙(Quota 제한 존재)을 넣을 경우 관리 복잡도가 증가하며, 라우터 ACL의 경우 물리 장비의 CPU 부하를 유발할 수 있으므로 최적화가 필요합니다.
> 
> 

Next Step: 심층 방어(Defense in Depth)를 위한 3계층 보안 설계 실습

상태 유지 방식
규칙 우선순위
임시 포트 허용
네트워크 계층 보안

---

안녕하세요! 보안 그룹, NACL, 라우터 ACL의 차이점을 한눈에 보실 수 있도록 표와 상세 설명을 정리해 드렸습니다. 특히 실무에서 가장 중요한 '반환 트래픽 처리(Stateful vs Stateless)'와 '규칙 적용 순서'를 강조하여 작성했습니다. 깃허브에서 바로 사용 가능한 형식이며, 과금 정보와 핵심 주의 사항을 포함했습니다. 모든 개인별 맞춤 설정을 준수하였습니다. 추가로 실제 설정 명령어가 필요하시면 말씀해 주세요.
