VPC 피어링(VPC Peering)은 두 개의 VPC 간에 트래픽을 라우팅할 수 있게 하는 네트워크 연결 서비스입니다. 동일한 네트워크에 있는 것처럼 사설 IP(Private IP)를 사용하여 서로 다른 VPC의 리소스 간에 통신할 수 있도록 지원합니다.

---

## VPC 피어링의 주요 특징

### 1. 논리적 통합

VPC 피어링은 물리적인 장비나 VPN 연결 없이 AWS의 기존 인프라를 사용하여 생성됩니다. 따라서 통신 시 단일 장애점(Single Point of Failure)이나 대역폭 병목 현상이 발생하지 않습니다.

### 2. 리전 및 계정 간 연결

* **리전 간 피어링 (Inter-Region Peering):** 서로 다른 AWS 리전에 있는 VPC끼리도 연결이 가능합니다.
* **계정 간 피어링 (Inter-Account Peering):** 내가 소유한 계정뿐만 아니라 다른 사람의 AWS 계정에 속한 VPC와도 피어링을 맺을 수 있습니다.

### 3. 보안성

트래픽이 공용 인터넷을 통하지 않고 AWS 내부 프라이빗 네트워크 망 내에서만 이동하므로 보안 위협이 적고 성능이 안정적입니다.

### 4. 전이적 루팅 불가 (No Transitive Peering)

VPC 피어링의 가장 중요한 제약 사항입니다.

* 예: VPC A가 VPC B와 연결되어 있고, VPC B가 VPC C와 연결되어 있어도, **VPC A와 VPC C는 직접 통신할 수 없습니다.** A와 C가 통신하려면 별도의 피어링을 직접 맺거나 Transit Gateway를 사용해야 합니다.

---

## VPC 피어링 설정 시 주의사항

1. **IP 대역 중복 불가:** 피어링을 맺으려는 두 VPC의 IPv4 CIDR 블록이 겹치면 피어링을 생성할 수 없습니다.
2. **라우팅 테이블 업데이트:** 피어링 연결을 '수락(Accept)'한 후에는 반드시 각 VPC의 라우팅 테이블에 상대방 VPC의 IP 대역과 피어링 ID를 수동으로 등록해야 통신이 가능합니다.
3. **보안 그룹 설정:** 상대방 VPC의 프라이빗 IP 주소에 대해 인바운드/아웃바운드 규칙을 허용해야 합니다.

---

## AWS VPC 피어링 과금 체계

VPC 피어링 자체를 생성하고 유지하는 데 드는 **고정 비용(시간당 비용)은 없습니다.** 하지만 데이터 전송량에 따라 다음과 같이 과금됩니다.

| 구분 | 과금 상세 | 주의 사항 |
| --- | --- | --- |
| **피어링 생성 비용** | **무료** | 생성 및 유지는 비용이 들지 않음 |
| **동일 리전 내 데이터 전송** | **$0.01 / GB (양방향)** | 동일 가용 영역(AZ) 내에서도 피어링 통신 시 과금 발생 가능 |
| **리전 간(Inter-Region) 전송** | **표준 리전 간 데이터 전송 요금** | 리전마다 다르나 보통 **$0.02 / GB** 수준부터 시작 |
| **유료 전환 예정 항목** | **VPC 암호화 트래픽 제어** | 2026년 3월 1일 이후 관련 관리 기능 유료화 가능성 확인 필요 |

> [!TIP]
> **비용 최적화 팁**
> VPC 피어링은 NAT 게이트웨이나 VPN보다 비용 효율적입니다. 하지만 연결해야 할 VPC가 수십 개로 늘어난다면 관리 복잡도와 비용 관리를 위해 **Transit Gateway** 도입을 검토해야 합니다.

---

VPC 피어링의 실무적인 이해를 돕기 위해 구체적인 IP 주소 대역을 가정한 설계 사례와 제한 사항, 그리고 실제 설정 방법을 정리합니다.

---

## VPC 피어링 아키텍처 사례 설계

두 개의 서로 다른 목적을 가진 VPC가 사설망으로 통신해야 하는 상황을 가정합니다.

### 1. 시나리오 구성

* **VPC A (서비스 망)**: 웹 서버가 위치한 공간
* **CIDR**: `10.0.0.0/16`
* **서브넷 IP**: `10.0.1.0/24`


* **VPC B (데이터 망)**: 공통 데이터베이스가 위치한 공간
* **CIDR**: `192.168.0.0/16`
* **서브넷 IP**: `192.168.1.0/24`



---

## VPC 피어링의 주요 제한 사항 사례

### 1. IP 대역 중복 (Overlapping CIDR)

VPC 피어링은 연결하려는 두 VPC의 IP 주소 범위가 단 하나라도 겹치면 생성이 불가능합니다.

* **불가 사례**: VPC A(`10.0.0.0/16`)와 VPC C(`10.0.0.0/24`)는 피어링을 맺을 수 없습니다. C의 대역이 A에 포함되기 때문입니다.

### 2. 전이적 피어링 불가 (No Transitive Peering)

네트워크가 체인처럼 연결되어 있어도 중간 단계를 거쳐 통신할 수 없습니다.

* **상황**: VPC A ↔ VPC B(연결됨), VPC B ↔ VPC C(연결됨)
* **결과**: VPC A는 VPC C와 직접 통신할 수 없습니다. A에서 C로 패킷을 보내면 B에서 멈추거나 드랍됩니다.
* **해결**: VPC A와 VPC C 사이에 별도의 피어링을 맺거나, 중앙 집중식인 Transit Gateway를 도입해야 합니다.

---

## 실무 설정 가이드: 라우팅 테이블 등록

피어링 연결 상태가 `Active`가 되어도 라우팅 테이블을 수정하지 않으면 통신이 되지 않습니다. 실제 IP 주소를 활용한 등록 방법은 다음과 같습니다.

### 1. VPC A (10.0.0.0/16)의 라우팅 테이블 설정

VPC A에 속한 인스턴스가 192.168 대역으로 가려고 할 때, 피어링 통로로 가라고 알려주어야 합니다.

| 대상 (Destination) | 타겟 (Target) | 설명 |
| --- | --- | --- |
| `10.0.0.0/16` | local | 내부 통신 |
| **`192.168.0.0/16`** | **`pcx-1a2b3c4d`** | VPC B로 가는 길을 피어링 ID로 지정 |

### 2. VPC B (192.168.0.0/16)의 라우팅 테이블 설정

반대로 VPC B에서도 응답을 보내거나 A로 접속하기 위한 경로가 필요합니다.

| 대상 (Destination) | 타겟 (Target) | 설명 |
| --- | --- | --- |
| `192.168.0.0/16` | local | 내부 통신 |
| **`10.0.0.0/16`** | **`pcx-1a2b3c4d`** | VPC A로 가는 길을 동일한 피어링 ID로 지정 |

---

## 설정 시 보안 그룹(Security Group) 주의 사항

라우팅 테이블 설정 후에도 **보안 그룹**에서 트래픽을 허용해야 합니다.

* **VPC B의 DB 보안 그룹 설정 예시**:
* **유형**: MSSQL(1433) 또는 MySQL(3306)
* **프로토콜**: TCP
* **포트 범위**: 서비스 포트
* **소스(Source)**: `10.0.1.0/24` (VPC A의 특정 서브넷 대역만 허용하여 보안 강화)



---

## 과금 및 유료 전환 주의 사항

* **데이터 처리 비용**: VPC 피어링 자체는 무료지만, 위 사례처럼 `10.0.x.x`에서 `192.168.x.x`로 데이터를 보낼 때 **GB당 $0.01**의 데이터 전송료가 발생합니다(동일 리전 기준).
* **리전 간 비용**: 만약 VPC A는 서울, VPC B는 버지니아에 있다면 리전 간 데이터 전송 요금이 적용되어 비용이 상승합니다.
* **DNS 호환 유료**: 피어링 간에 프라이빗 DNS 이름을 확인하도록 설정할 경우, Route 53 프라이빗 호스팅 존 사용 시 관련 쿼리 비용이 발생할 수 있습니다.

Next Step: Transit Gateway를 이용한 다중 VPC 연결 아키텍처

사설 IP 설계
라우팅 타겟
보안 그룹 소스
전송 요금

---
