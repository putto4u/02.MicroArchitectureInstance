## AWS EC2 인스턴스 생성 및 웹 서버 자동 구성 실습

이 장에서는 AWS 관리 콘솔(Management Console)을 사용하여 실제로 EC2 인스턴스를 생성합니다. 단순한 OS 설치를 넘어, 앞서 학습한 **보안 그룹(80번 포트 개방)** 설정을 적용하고 **사용자 데이터(User Data)** 스크립트를 통해 부팅 시 웹 서버(Nginx)가 자동으로 설치되도록 구성합니다.

> **※ 과금 주의:** 신규 가입 12개월 미만 사용자는 **Free Tier**가 적용되는 인스턴스 타입(`t2.micro` 또는 `t3.micro`)을 선택해야 무료로 이용 가능합니다. 그 외 타입을 선택할 경우 즉시 요금이 발생합니다.

---

### 1. 리전 선택 및 메뉴 진입

가장 먼저 우측 상단 네비게이션 바에서 리전이 **아시아 태평양(서울) `ap-northeast-2**` 로 되어 있는지 확인합니다.

1. 콘솔 상단 검색창에 `EC2` 입력 후 선택.
2. 왼쪽 메뉴 대시보드 또는 중앙 화면의 주황색 **[인스턴스 시작 (Launch Instances)]** 버튼 클릭.

---

### 2. 단계별 상세 설정

한 화면에서 모든 설정이 이루어집니다. 위에서부터 순서대로 내려오며 설정합니다.

#### 2.1 이름 및 태그 (Name and tags)

* **이름:** `Web-Server-Lab01` (식별하기 쉬운 이름 입력)

#### 2.2 애플리케이션 및 OS 이미지 (AMI)

서버의 운영체제를 선택합니다.

* **Quick Start:** **Amazon Linux** 선택 (AWS에서 제공하는 가장 표준적인 Linux)
* **AMI:** `Amazon Linux 2023 AMI` (Free tier eligible 표시 확인)
* **아키텍처:** `64비트(x86)` 기본값 유지

#### 2.3 인스턴스 유형 (Instance type)

서버의 하드웨어 스펙(CPU, RAM)을 결정합니다.

* **인스턴스 유형:** **`t2.micro`** 또는 **`t3.micro`** 선택.
* *반드시 '프리 티어 사용 가능(Free tier eligible)' 태그를 확인하세요.*



#### 2.4 키 페어 (로그인)

서버에 SSH로 접속하기 위한 비밀번호 파일입니다.

* **키 페어 이름:** **[새 키 페어 생성]** 클릭.
* **키 페어 이름:** `my-key-01`
* **키 페어 유형:** `RSA`
* **프라이빗 키 파일 형식:** `.pem` (OpenSSH, Mac, Windows 10+ PowerShell용)
* **[키 페어 생성]** 버튼을 누르면 브라우저에서 파일이 다운로드됩니다. **(※ 중요: 이 파일은 재발급이 불가능하므로 절대 잃어버리면 안 됩니다.)**

#### 2.5 네트워크 설정 (Network settings) - **[매우 중요]**

우측 **[편집(Edit)]** 버튼을 눌러 세부 메뉴를 펼칩니다.

* **VPC:** `(기본값) default`
* **서브넷:** `선호 없음` (자동 선택)
* **퍼블릭 IP 자동 할당:** **활성화 (Enable)** (이것이 켜져 있어야 외부 접속 가능)
* **방화벽(보안 그룹):** **[보안 그룹 생성]** 선택.
* **보안 그룹 이름:** `Web-Server-SG`
* **인바운드 보안 그룹 규칙 (Inbound security groups rules):**
1. **SSH (TCP 22):** 소스 유형을 **[내 IP (My IP)]**로 변경. (보안 권장 사항)
2. **[보안 그룹 규칙 추가]** 버튼 클릭.
3. **HTTP (TCP 80):** 유형을 `HTTP`로 선택, 소스 유형은 **[위치 무관 (Anywhere, 0.0.0.0/0)]**. (웹 서버용)



#### 2.6 스토리지 구성 (Storage)

* **크기:** `8` GiB (프리 티어는 최대 30GB까지 무료)
* **볼륨 유형:** `gp3` (최신 범용 SSD)

---

### 3. 고급 세부 정보: 사용자 데이터 (User Data) 활용

이 설정은 전문가들이 **'부팅 스크립트'**를 심는 단계입니다. 서버가 처음 켜질 때 자동으로 실행할 명령어를 미리 입력해 둡니다.

1. 스크롤을 맨 아래로 내려 **[고급 세부 정보]** 탭을 펼칩니다.
2. 가장 하단 **사용자 데이터(User data)** 입력창에 아래 내용을 복사해서 붙여넣습니다. (Amazon Linux 2023 기준)

```bash
#!/bin/bash
dnf update -y
dnf install nginx -y
systemctl start nginx
systemctl enable nginx
echo "<h1>Hello! AWS EC2 Web Server Setup Complete</h1>" > /usr/share/nginx/html/index.html

```

> **스크립트 설명:** 시스템 업데이트 -> Nginx 웹 서버 설치 -> 서비스 시작 -> 재부팅 시 자동 시작 설정 -> 메인 페이지(index.html) 교체

---

### 4. 인스턴스 시작 및 접속 확인

1. 우측 화면의 **[인스턴스 시작]** 주황색 버튼 클릭.
2. **[모든 인스턴스 보기]**를 클릭하여 목록으로 이동.
3. **상태 확인:** `인스턴스 상태`가 **실행 중(Running)**이고, `상태 검사`가 **2/2 통과**가 될 때까지 약 1~2분 대기합니다.
4. **웹 접속 테스트:**
* 인스턴스를 클릭하고 하단 세부 정보에서 **퍼블릭 IPv4 주소**를 복사합니다. (예: `3.12.34.56`)
* 웹 브라우저 주소창에 `http://[퍼블릭IP]`를 입력합니다.
* **"Hello! AWS EC2 Web Server Setup Complete"** 문구가 보이면 실습 성공입니다.



---

### 5. 실습 종료 후 리소스 정리 (삭제)

클라우드 실습의 끝은 반드시 **리소스 삭제**여야 합니다. 켜두면 과금됩니다.

1. 인스턴스 목록에서 `Web-Server-Lab01` 체크.
2. 상단 **[인스턴스 상태]** 메뉴 클릭 > **[인스턴스 종료 (Terminate instance)]** 선택.
3. 경고 팝업에서 **[종료]** 클릭.
* *참고:* 인스턴스 상태가 '종료됨(Terminated)'으로 바뀌면 과금이 중단된 것이며, 목록에서는 잠시 후 사라집니다.



---

Next Step: 생성한 EC2 인스턴스에 SSH 클라이언트(터미널)로 직접 접속하는 방법 (Windows/Mac)

---
# [비용 분석] EC2 실습 시 예상 청구 금액

본 실습을 진행할 때 발생하는 비용은 **AWS 계정의 생성 시점(프리 티어 적용 여부)**에 따라 달라집니다. 특히 2024년 2월부터 적용된 **퍼블릭 IPv4 요금 정책**을 주의 깊게 확인해야 합니다.

---

### 1. 신규 가입자 (프리 티어 적용 대상)

가입한 지 12개월 미만이며, 프리 티어 혜택 한도를 넘지 않은 계정의 경우입니다.

| 항목 | 요금 정책 | 예상 비용 |
| --- | --- | --- |
| **EC2 인스턴스** | `t2.micro` 또는 `t3.micro` 월 750시간 무료 | **0 USD** |
| **EBS 스토리지** | 범용 SSD(gp2/gp3) 월 30GB 무료 | **0 USD** |
| **퍼블릭 IPv4** | 월 750시간 무료 (인스턴스에 할당된 경우) | **0 USD** |
| **데이터 전송** | 아웃바운드 월 100GB 무료 | **0 USD** |
| **총계** | **실습 후 즉시 종료 시** | **무료** |

> **주의:** 프리 티어는 '월간 총합' 기준입니다. 인스턴스를 2개 띄우면 시간은 2배로 차감되므로, 실습이 끝나면 반드시 **종료(Terminate)**해야 안전합니다.

---

### 2. 기존 가입자 (프리 티어 만료 대상)

가입 후 12개월이 지났거나, 이미 이번 달 프리 티어 한도를 모두 소진한 경우 발생하는 **시간당** 요금입니다. (서울 리전 `ap-northeast-2` 기준, 환율 변동 및 세금 제외)

#### A. 시간당 비용 상세 (단가)

1. **컴퓨팅 (EC2):**
* `t2.micro`: 약 **$0.0116** / 시간
* `t3.micro`: 약 **$0.0104** / 시간


2. **IP 주소 (Public IPv4):**
* 모든 퍼블릭 IPv4 주소: **$0.0050** / 시간 (유료 과금 항목)


3. **스토리지 (EBS gp3):**
* 월 $0.08/GB (8GB 기준 월 약 $0.64, 시간당 약 $0.0008)



#### B. 실습 시간별 예상 청구액 (합계)

아래 비용은 `t2.micro` + `8GB EBS` + `1 Public IP`를 기준으로 계산된 추정치입니다.

| 사용 시간 | 예상 청구액 (USD) | 한화 환산 (약 1,400원/$ 기준) |
| --- | --- | --- |
| **1시간 (실습 직후 종료)** | **$0.017** | **약 24원** |
| **24시간 (하루 방치)** | **$0.42** | **약 590원** |
| **30일 (한 달 내내 켜둠)** | **$12.60** | **약 17,640원** |

---

### 3. 과금 방지를 위한 핵심 체크포인트

비용 발생을 막기 위해 실습 종료 시 다음 사항을 반드시 확인해야 합니다.

1. **인스턴스 상태:** '중지됨(Stopped)' 상태에서도 **EBS 스토리지 요금**과 **탄력적 IP(EIP)를 연결한 경우 IP 요금**은 계속 발생합니다. 더 이상 사용하지 않는다면 반드시 **'종료(Terminated)'** 시켜야 합니다.
2. **탄력적 IP(Elastic IP) 해제:** 만약 실습 중 '탄력적 IP'를 별도로 할당받았다면, 인스턴스를 종료해도 IP는 남아있어 요금($0.005/시간)이 부과됩니다. 반드시 **[네트워크 및 보안] > [탄력적 IP]** 메뉴에서 **IP 릴리스(Release)**를 수행해야 합니다.

Next Step: 생성한 EC2 인스턴스에 SSH 클라이언트(터미널)로 직접 접속하는 방법 (Windows/Mac)
