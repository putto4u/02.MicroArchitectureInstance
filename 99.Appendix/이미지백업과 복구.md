## 골든 인스턴스(Golden Instance) 백업 및 복구 가이드

**골든 인스턴스**란 운영체제, 필요한 모든 소프트웨어 설정, 보안 패치 등이 완료되어 즉시 서비스에 투입 가능한 '표준 템플릿' 상태의 인스턴스를 의미합니다. 이를 백업하고 복구하는 과정은 클라우드 인프라 운영의 핵심입니다.

---

### 1. 골든 인스턴스 백업: AMI 생성

AWS에서는 인스턴스의 현재 상태를 **AMI(Amazon Machine Image)**로 저장하여 백업합니다.

1. **인스턴스 정제**: 백업 전 임시 파일, 로그, 히스토리(`~/.bash_history`) 등을 삭제하여 이미지를 최소화합니다.
2. **이미지 생성**: EC2 콘솔에서 대상 인스턴스 선택 > `작업` > `이미지 및 템플릿` > `이미지 생성`을 클릭합니다.
3. **재부팅 안 함 옵션**: 기본적으로 AMI 생성 시 인스턴스가 재부팅됩니다. 서비스 중단이 불가능하다면 '재부팅 안 함'을 체크하되, 데이터 무결성을 위해 가급적 중단 후 생성을 권장합니다.
4. **결과 확인**: 생성된 이미지는 EC2 메뉴의 `이미지` > `AMI` 탭에서 확인할 수 있습니다.

---

### 2. 골든 인스턴스 복구: 새 인스턴스 시작

백업된 AMI를 사용하여 동일한 환경의 서버를 여러 대 복구하거나 새로 생성할 수 있습니다.

1. **AMI 선택**: EC2 콘솔의 `AMI` 메뉴에서 생성해둔 골든 이미지를 선택하고 `AMI로 인스턴스 시작`을 클릭합니다.
2. **인스턴스 유형 및 설정**: 기존 인스턴스와 동일하거나 필요한 사양의 인스턴스 유형을 선택합니다.
3. **네트워크 및 보안 설정**: 복구 시점에 적합한 VPC, 서브넷, 보안 그룹을 다시 지정합니다.
4. **검증**: 인스턴스 실행 후 서비스가 정상적으로 동작하는지 확인합니다.

---

### 3. 비용 및 관리 주의사항

| 항목 | 상세 내용 | 과금 여부 |
| --- | --- | --- |
| **EBS 스냅샷 저장** | AMI는 EBS 스냅샷 형태로 저장되며 용량만큼 비용 발생 | **유료** (GB당 과금) |
| **프리티어 혜택** | EBS 스냅샷 저장 용량 총합 1GB까지 무료 제공 | 1GB 초과 시 **유료** |
| **이미지 삭제** | AMI만 '등록 취소'하면 비용이 계속 나감. 반드시 **연관된 스냅샷도 삭제**해야 함 | 관리 부주의 시 **과금 지속** |

---

### 4. 깃허브 관리를 위한 CLI 명령어

```bash
# 1. 실행 중인 인스턴스로부터 AMI 생성 (AWS CLI)
# --no-reboot 옵션을 넣으면 재부팅 없이 생성 시도
aws ec2 create-image \
    --instance-id i-1234567890abcdef0 \
    --name "MyGoldenInstance-$(date +%Y%m%d)" \
    --description "Web Server Golden Image" \
    --no-reboot

# 2. 생성된 AMI ID 확인
aws ec2 describe-images --owners self --query 'Images[*].{Name:Name,ID:ImageId}'

```

Next Step: 오토 스케일링(Auto Scaling)과 골든 이미지 연동 방법

설명드린 내용은 표준적인 AMI 백업/복구 절차이며, 1GB 초과 시 스토리지 비용이 발생할 수 있으니 테스트 후에는 불필요한 스냅샷을 꼭 삭제하시기 바랍니다.

Next Step: 오토 스케일링 그룹 구성 및 활용 전략
