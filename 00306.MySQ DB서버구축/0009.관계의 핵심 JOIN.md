# Chapter 6-3. 테이블 간의 연결, JOIN의 종류와 활용

관계형 데이터베이스(RDB)의 꽃은 '관계'를 활용하는 것입니다. 데이터가 여러 테이블에 분산되어 저장되어 있을 때, 이를 기준 키(Key)를 사용하여 하나의 논리적인 결과 집합으로 합치는 기술이 바로 **JOIN**입니다.

가장 빈번하게 사용되는 4가지 기본 JOIN 방식을 다룹니다.

---

### 0. 실습을 위한 가정 (테이블 구조)

설명을 돕기 위해 두 개의 테이블이 있다고 가정합니다.

* **A 테이블 (employees):** 직원 정보 (직원ID, 이름, `부서ID`)
* **B 테이블 (departments):** 부서 정보 (`부서ID`, 부서명)
* **연결 고리:** `부서ID` (Foreign Key)

---

### 1. INNER JOIN (내부 조인)

**"양쪽 모두에 존재하는 데이터만 조회"**

가장 기본적이고 많이 쓰이는 방식입니다. 두 테이블의 연결 조건이 **완벽하게 일치하는 행(Row)**만 가져옵니다. (집합의 **교집합**)

* **상황:** "부서가 배정된 직원들의 정보와 그 부서명을 보고 싶다." (부서가 없는 신입사원이나, 직원이 없는 신생 부서는 제외됨)
* **문법:** `INNER` 키워드는 생략하고 그냥 `JOIN`이라고만 써도 됩니다.

```sql
SELECT e.name, d.dept_name
FROM employees e                -- 별칭(Alias) 'e' 사용
INNER JOIN departments d        -- 별칭(Alias) 'd' 사용
ON e.dept_id = d.dept_id;       -- 두 테이블을 잇는 조건

```

### 2. LEFT OUTER JOIN (왼쪽 외부 조인)

**"왼쪽 테이블은 무조건 다 보여주고, 오른쪽은 있으면 보여줌"**

`LEFT JOIN`을 기준으로 왼쪽(먼저 쓴 테이블)의 모든 데이터를 가져옵니다. 오른쪽 테이블에 매칭되는 데이터가 없으면 **NULL**로 채워집니다.

* **상황:** "모든 직원을 다 조회하되, 부서가 있으면 부서명을 표시하고 없으면 비워둬라."
* **특징:** 데이터의 누락 없이 기준 테이블(Left)의 현황을 파악할 때 필수적입니다.

```sql
SELECT e.name, d.dept_name
FROM employees e
LEFT JOIN departments d
ON e.dept_id = d.dept_id;
-- 결과: 부서가 없는 직원의 dept_name 컬럼에는 'NULL'이 표시됨

```

### 3. RIGHT OUTER JOIN (오른쪽 외부 조인)

**"오른쪽 테이블은 무조건 다 보여주고, 왼쪽은 있으면 보여줌"**

`LEFT JOIN`의 방향만 반대인 개념입니다. 오른쪽 테이블의 모든 데이터를 가져옵니다.

* **상황:** "직원이 한 명도 없는 부서를 포함하여, 모든 부서 목록과 소속 직원을 확인하고 싶다."
* **참고:** 실무에서는 헷갈림 방지를 위해 `RIGHT JOIN`을 잘 쓰지 않고, 테이블 순서를 바꿔서 `LEFT JOIN`으로 통일하여 사용하는 경향이 있습니다.

```sql
SELECT e.name, d.dept_name
FROM employees e
RIGHT JOIN departments d
ON e.dept_id = d.dept_id;

```

### 4. CROSS JOIN (교차 조인)

**"모든 경우의 수 (카테시안 곱)"**

연결 조건(`ON` 절) 없이, A테이블의 모든 행과 B테이블의 모든 행을 무작위로 결합합니다.

* **결과 행 수:** A테이블 행 개수 × B테이블 행 개수
* **주의:** 의도치 않게 사용하면 데이터 양이 폭증하여 DB 성능을 마비시킬 수 있습니다. 테스트 데이터를 대량으로 생성할 때 주로 사용합니다.

```sql
SELECT *
FROM employees
CROSS JOIN departments;

```

---

### (참고) MySQL에서의 FULL OUTER JOIN

**FULL JOIN**은 양쪽 테이블의 모든 데이터를 합치는 방식(합집합)입니다.

* 오라클이나 PostgreSQL 등은 `FULL OUTER JOIN` 문법을 지원하지만, **MySQL은 이를 직접 지원하지 않습니다.**
* **해결책:** `LEFT JOIN`과 `RIGHT JOIN`을 **`UNION`**(합집합 연산자)으로 연결하여 구현합니다.

```sql
-- MySQL 스타일의 Full Join 구현
SELECT * FROM employees e LEFT JOIN departments d ON e.dept_id = d.dept_id
UNION
SELECT * FROM employees e RIGHT JOIN departments d ON e.dept_id = d.dept_id;

```

Next Step: 데이터를 그룹화하여 통계를 내는 GROUP BY와 집계 함수(COUNT, SUM, AVG)
